{
  "name": "patch-agent-mcp",
  "version": "0.1.0",
  "description": "MCP server exposing patch-clamp analysis tools",
  "tools": {
    "load_file": {
      "description": "Load an electrophysiology file (ABF or NWB)",
      "parameters": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Path to the file (.abf or .nwb)"
          },
          "return_metadata": {
            "type": "boolean",
            "description": "Whether to include file metadata",
            "default": false
          }
        },
        "required": ["file_path"]
      }
    },
    "get_file_metadata": {
      "description": "Get metadata from an electrophysiology file",
      "parameters": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Path to the file"
          }
        },
        "required": ["file_path"]
      }
    },
    "detect_spikes": {
      "description": "Detect action potentials in a voltage trace",
      "parameters": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Path to file or pre-loaded data"
          },
          "sweep_number": {
            "type": "integer",
            "description": "Sweep index (0-based)",
            "default": 0
          },
          "dv_cutoff": {
            "type": "number",
            "description": "dV/dt threshold (mV/ms)",
            "default": 20.0
          },
          "min_peak": {
            "type": "number",
            "description": "Minimum peak voltage (mV)",
            "default": -30.0
          }
        },
        "required": ["file_path"]
      }
    },
    "extract_spike_features": {
      "description": "Extract detailed features for each spike",
      "parameters": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Path to file"
          },
          "sweep_number": {
            "type": "integer",
            "description": "Sweep index",
            "default": 0
          }
        },
        "required": ["file_path"]
      }
    },
    "calculate_input_resistance": {
      "description": "Calculate input resistance from current step response",
      "parameters": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Path to file"
          },
          "sweep_number": {
            "type": "integer",
            "description": "Sweep index",
            "default": 0
          }
        },
        "required": ["file_path"]
      }
    },
    "calculate_time_constant": {
      "description": "Calculate membrane time constant from exponential fit",
      "parameters": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Path to file"
          },
          "sweep_number": {
            "type": "integer",
            "description": "Sweep index",
            "default": 0
          },
          "fit_duration": {
            "type": "number",
            "description": "Duration of fit window (seconds)",
            "default": 0.1
          }
        },
        "required": ["file_path"]
      }
    },
    "run_sweep_qc": {
      "description": "Run quality control checks on a sweep",
      "parameters": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Path to file"
          },
          "sweep_number": {
            "type": "integer",
            "description": "Sweep index",
            "default": 0
          }
        },
        "required": ["file_path"]
      }
    },
    "fit_exponential": {
      "description": "Fit exponential decay or growth to data",
      "parameters": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Path to file"
          },
          "sweep_number": {
            "type": "integer",
            "description": "Sweep index",
            "default": 0
          },
          "fit_type": {
            "type": "string",
            "enum": ["decay", "growth"],
            "default": "decay"
          }
        },
        "required": ["file_path"]
      }
    }
  },
  "resources": {
    "sample_data": {
      "uri": "file://data/sample_abfs/",
      "description": "Sample ABF files for testing"
    }
  }
}
